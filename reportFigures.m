aVL_00= [-2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 0 0 0 2 4 7 9 10 14 17 21 26 31 37 44 52 59 66 71 74 77 79 79 79 77 77 77 77 77 79 81 84 89 96 104 114 126 136 144 151 154 158 159 161 163 164 166 166 166 166 163 159 156 151 146 141 134 128 119 109 97 86 74 62 51 41 31 22 14 5 0 -4 -9 -10 -12 -12 -12 -14 -14 -14 -15 -15 -17 -17 -17 -19 -19 -19 -19 -19 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -22 -22 -22 -24 -24 -24 -24 -24 -24 -24 -25 -25 -25 -25 -25 -25 -25 -27 -27 -27 -29 -29 -29 -29 -30 -30 -30 -30 -30 -32 -32 -32 -34 -34 -35 -35 -35 -37 -37 -37 -37 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -37 -37 -37 -35 -35 -34 -34 -32 -30 -30 -29 -27 -27 -25 -24 -22 -20 -17 -15 -14 -12 -10 -10 -10 -9 -9 -7 -7 -5 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -2 -2 -2 0 0 0 0 0 0 0 -2 -2 -2 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -4 -4 -4 -4 -2 -2 0 0 2 2 4 4 4 4 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 4 5 7 9 10 12 14 15 19 24 29 36 42 49 56 61 66 69 72 72 71 71 69 67 67 67 67 69 72 76 81 84 89 94 97 103 108 114 119 126 133 138 143 146 149 151 151 151 151 149 148 144 139 133 124 116 106 96 87 79 69 61 52 42 34 26 17 10 5 0 -2 -4 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -9 -9 -9 -9 -9 -10 -10 -10 -10 -10 -10 -10 -10 -10 -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 -14 -14 -14 -15 -15 -15 -15 -15 -15 -15 -17 -17 -19 -19 -19 -20 -20 -20 -20 -20 -22 -22 -22 -22 -22 -24 -24 -24 -25 -25 -27 -27 -27 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -27 -27 -27 -27 -27 -25 -25 -25 -25 -24 -24 -24 -24 -22 -20 -19 -17 -14 -10 -9 -7 -5 -5 -4 -4 -4 -2 -2 0 0 2 4 4 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4 4 4 4 4 2 2 2 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 5 5 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 7 7 5 4 4 4 4 4 4 5 7 7 9 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 12 12 14 15 19 21 22 26 29 32 37 44 51 57 62 66 67 67 66 64 62 61 59 59 59 59 57 57 59 61 62 66 71 77 86 94 103 113 121 129 136 139 141 143 141 141 141 139 139 139 138 134 129 123 114 104 96 87 82 76 71 64 54 44 32 22 14 9 5 4 2 2 0 0 0 -2 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -7 -7 -9 -9 -9 -7 -7 -7 -7 -7 -7 -7 -7 -9 -9 -9 -9 -10 -10 -10 -10 -10 -10 -10 -10 -10 -12 -12 -12 -14 -14 -14 -15 -15 -17 -17 -19 -19 -19 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -22 -22 -22 -22 -22 -20 -20 -20 -20 -19 -19 -19 -19 -19 -17 -17 -15 -14 -12 -12 -10 -9 -9 -7 -7 -5 -5 -4 -2 0 0 0 2 2 4 4 4 4 4 4 4 5 5 5 5 7 7 7 9 9 9 9 9 9 9 9 9 10 10 10 10 9 9 9 9 7 7 7 7 7 7 7 7 7 9 9 9 9 10 10 10 10 10 10 10 9 9 9 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 7 7 7 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5]
fs = 500

smooth_signal = movmean(aVL_00, 21)


[~,locs,~, tm] = find_RPeaks(aVL_00,fs)
[~,locs2,~, tm2] = find_RPeaks(smooth_signal,fs)

[locs3] = R_Correction(aVL_00,tm,fs,locs2)

figure()
subplot(3,1,1)
plot(tm, aVL_00)
xline(locs(1))
xline(locs(2))
xline(locs(3))
title("Result of Find R-Peaks on Raw Data")

subplot(3,1,2)
plot(tm, smooth_signal)
xline(locs2(1)+3/fs)
xline(locs2(2)+3/fs)
xline(locs2(3)+3/fs)
title("Result of Find R-Peaks on Smoothed Data")

subplot(3,1,3)
plot(tm, aVL_00)
xline(locs(1), 'r')
xline(locs(2), 'r')
xline(locs(3), 'r')
xline(locs2(1)+3/fs, 'b')
xline(locs2(2)+3/fs, 'b')
xline(locs2(3)+3/fs, 'b')
xline(locs3(1), 'y')
xline(locs3(2), 'y')
xline(locs3(3), 'y')
title("Result of Find R-Peaks and R-Correction Functions on Raw Data")
