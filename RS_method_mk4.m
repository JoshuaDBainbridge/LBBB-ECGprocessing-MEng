V6_00 = [-9 -9 -8 -8 -8 -8 -8 -8 -8 -8 -8 -8 -9 -9 -9 -9 -9 -9 -11 -11 -11 -11 -11 -11 -11 -11 -11 -11 -11 -11 -13 -14 -16 -16 -18 -18 -18 -18 -18 -18 -18 -18 -18 -18 -18 -18 -18 -18 -18 -16 -14 -13 -11 -9 -9 -8 -8 -6 -4 -3 -1 1 5 8 10 11 13 15 16 20 21 25 28 30 31 33 35 35 35 35 35 35 35 33 33 33 33 31 31 31 31 30 30 30 30 30 30 30 28 28 28 28 28 28 28 28 28 28 28 26 26 25 23 23 23 23 23 23 23 23 23 25 25 25 26 26 26 26 26 26 28 28 28 28 28 26 26 26 25 25 23 23 23 23 21 21 21 21 21 23 23 23 25 25 26 26 26 26 25 25 25 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 21 21 20 18 18 18 18 18 20 21 23 25 26 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 30 31 31 33 35 36 38 38 40 40 40 40 40 40 40 40 40 40 38 38 36 35 35 33 33 31 31 31 30 30 30 30 30 30 30 30 30 30 31 31 31 31 33 33 33 33 33 33 33 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 33 33 33 31 31 31 33 35 36 41 45 48 52 53 53 53 55 55 58 60 63 68 72 77 82 85 88 93 97 102 107 115 123 134 145 155 164 169 172 172 172 170 169 169 167 165 165 164 162 160 160 159 159 159 159 157 157 155 154 152 150 147 145 142 137 134 127 122 115 108 100 92 83 75 67 58 50 43 36 31 28 26 26 25 25 25 25 25 25 23 23 23 23 23 23 21 21 21 21 21 21 21 20 20 20 20 18 18 16 16 15 15 13 13 13 13 13 13 11 11 11 11 11 11 11 11 11 10 10 10 10 10 10 10 8 8 6 5 3 1 0 -1 -3 -3 -3 -3 -3 -3 -4 -4 -4 -4 -4 -4 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -4 -3 -1 0 3 5 6 10 11 13 15 16 18 20 23 25 26 28 30 31 33 33 33 33 33 31 31 31 31 30 30 28 26 23 21 20 18 16 16 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 13 13 13 13 13 13 11 11 11 11 11 11 11 11 11 11 11 10 10 10 10 10 10 10 8 6 6 5 3 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -1 -1 -1 -1 -1 -1 -1 -1 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -4 -4 -4 -4 -4 -4 -6 -6 -6 -6 -8 -8 -8 -8 -8 -8 -8 -9 -9 -9 -11 -11 -11 -11 -11 -9 -9 -9 -8 -8 -8 -8 -8 -8 -8 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -6 -6 -6 -8 -8 -8 -9 -9 -9 -9 -11 -11 -11 -13 -13 -14 -14 -16 -16 -16 -16 -16 -18 -18 -18 -18 -18 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -21 -21 -21 -21 -21 -21 -21 -21 -21 -19 -19 -19 -18 -16 -14 -13 -11 -9 -8 -8 -8 -8 -6 -6 -4 -3 -1 0 3 6 10 15 21 26 33 40 45 52 55 60 67 72 77 82 87 90 92 93 93 92 92 90 87 85 83 82 80 80 78 78 78 77 77 77 77 77 77 75 73 68 63 55 48 41 35 30 26 21 18 13 6 1 -4 -9 -16 -21 -24 -26 -29 -31 -35 -36 -38 -40 -41 -41 -41 -41 -41 -41 -41 -43 -43 -43 -45 -45 -45 -45 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -46 -48 -48 -48 -48 -48 -48 -48 -48 -48 -48 -48 -50 -50 -50 -50 -50 -50 -50 -50 -51 -51 -51 -51 -51 -51 -53 -53 -55 -56 -58 -60 -60 -61 -61 -61 -61 -61 -61 -61 -61 -61 -61 -61 -61 -61 -61 -60 -60 -58 -58 -56 -55 -53 -51 -50 -50 -48 -48 -46 -45 -41 -40 -36 -35 -31 -29 -28 -24 -21 -18 -16 -13 -11 -11 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 -11 -13 -14 -16 -18 -19 -21 -21 -21 -21 -21 -23 -23 -23 -23 -24 -24 -24 -24 -24 -24 -24 -24 -24 -24 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -26 -28 -28 -28 -28 -28 -28 -28 -28 -28 -28 -28 -28 -28 -28 -28 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29]
V5_00 = [5 5 5 5 5 5 5 5 5 5 5 4 4 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 4 5 7 9 10 12 12 14 15 19 21 22 26 27 29 31 32 34 36 37 39 39 39 39 39 39 39 39 37 34 32 29 27 24 22 22 22 21 21 21 21 21 21 21 21 19 19 19 19 19 17 17 17 15 15 14 14 12 10 10 9 9 9 7 7 7 7 7 7 7 7 7 9 9 9 10 10 10 10 10 10 10 10 10 9 9 7 7 7 5 5 5 5 4 4 4 4 4 4 5 5 5 5 5 5 5 4 4 4 4 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 4 4 4 4 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 4 4 5 5 5 5 7 7 7 7 7 7 7 5 5 5 5 5 5 7 7 7 9 9 10 10 10 12 12 12 12 12 12 12 12 12 10 10 9 7 5 4 4 2 2 2 2 2 2 2 2 2 2 2 4 4 4 4 5 5 5 5 5 5 4 4 2 0 0 0 0 0 0 -2 -2 -2 -2 0 0 0 0 0 0 0 0 0 0 0 2 4 7 10 15 19 22 24 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 26 27 29 31 34 39 44 49 54 57 59 59 61 61 61 61 61 61 62 62 62 62 62 62 62 62 61 61 61 59 59 57 57 57 57 57 57 57 57 57 56 52 49 44 37 29 21 14 7 2 0 0 -2 -2 0 0 -2 -2 -2 -2 -2 0 0 0 0 0 0 0 0 0 0 -2 -2 -2 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -7 -7 -7 -7 -7 -9 -9 -9 -9 -10 -10 -10 -10 -10 -12 -12 -12 -12 -12 -12 -12 -12 -12 -10 -10 -9 -9 -7 -7 -5 -5 -4 -4 -2 -2 0 0 0 2 4 5 7 10 12 15 17 19 21 22 24 24 26 27 27 29 29 29 29 27 27 26 24 24 22 21 19 17 15 14 12 12 10 10 9 9 9 9 7 7 7 7 5 5 5 5 5 4 4 4 4 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -2 -2 -2 -2 -2 -2 -2 -4 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -7 -5 -5 -5 -4 -4 -4 -2 -2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -2 -2 -2 -2 -2 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -7 -7 -7 -7 -7 -9 -9 -9 -10 -10 -10 -10 -10 -10 -10 -10 -10 -10 -10 -10 -9 -7 -4 0 4 7 9 10 12 12 10 10 10 10 10 10 10 10 10 10 10 12 12 12 12 14 14 14 15 19 21 24 27 32 36 37 39 41 41 41 41 41 41 41 41 41 41 41 41 41 41 42 42 42 42 42 42 42 42 42 44 44 44 42 41 37 31 24 17 10 5 2 0 -4 -7 -9 -12 -14 -15 -17 -17 -17 -17 -19 -19 -19 -19 -19 -19 -19 -19 -19 -20 -20 -20 -20 -20 -20 -20 -20 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -24 -24 -24 -24 -24 -24 -24 -24 -24 -25 -25 -25 -25 -25 -27 -27 -27 -27 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -27 -27 -25 -22 -20 -19 -17 -15 -14 -12 -10 -9 -7 -4 -2 0 0 2 4 5 7 7 9 9 10 10 10 10 10 10 10 10 9 9 9 9 7 7 5 4 2 0 -2 -4 -5 -7 -9 -9 -9 -9 -9 -10 -10 -10 -10 -12 -12 -12 -12 -12 -12 -12 -12 -12 -14 -14 -14 -15 -15 -15 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -17 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -19 -20 -20 -20 -20 -20 -20 -20 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -22 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20]
V2_00 = [-11 -11 -11 -11 -11 -11 -11 -11 -9 -9 -9 -8 -8 -8 -6 -6 -4 -4 -4 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 1 3 6 11 18 23 30 33 33 30 20 5 -16 -41 -68 -96 -126 -155 -183 -210 -237 -262 -287 -312 -336 -359 -382 -404 -424 -443 -461 -475 -488 -496 -503 -506 -508 -508 -505 -498 -488 -476 -459 -443 -426 -408 -393 -376 -361 -346 -331 -316 -302 -292 -282 -272 -262 -249 -234 -218 -202 -183 -165 -148 -131 -115 -101 -90 -80 -70 -58 -46 -33 -21 -8 1 10 15 20 23 27 30 32 33 35 35 37 38 38 40 42 42 43 45 45 47 47 47 48 48 50 50 52 53 53 53 55 55 55 55 55 57 57 58 60 62 63 65 67 67 68 70 72 72 73 75 77 80 82 83 85 88 88 90 92 92 93 97 99 102 104 107 109 110 112 114 115 119 122 124 127 129 130 132 134 135 137 139 142 142 144 144 144 144 144 144 144 142 140 137 135 134 132 130 129 127 125 124 119 114 109 102 97 90 85 80 75 70 63 57 48 42 37 32 28 25 22 18 15 11 8 5 1 0 0 -1 -1 -1 -1 -3 -3 -3 -3 -3 -4 -4 -4 -4 -4 -4 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -8 -8 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -6 -8 -8 -8 -8 -8 -8 -8 -8 -8 -8 -6 -6 -6 -6 -6 -6 -4 -4 -4 -6 -6 -6 -6 -6 -6 -6 -8 -8 -8 -9 -9 -9 -11 -11 -13 -13 -13 -14 -14 -14 -14 -16 -16 -16 -16 -16 -16 -16 -16 -14 -14 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -13 -14 -14 -14 -14 -13 -13 -13 -13 -13 -13 -13 -11 -11 -11 -11 -11 -11 -11 -11 -11 -11 -11 -9 -6 -1 5 13 20 27 28 25 13 -3 -24 -51 -80 -108 -136 -165 -193 -220 -247 -274 -300 -327 -354 -379 -404 -428 -449 -468 -483 -496 -506 -513 -518 -518 -518 -513 -508 -498 -486 -471 -454 -434 -414 -394 -376 -359 -342 -331 -319 -307 -295 -284 -270 -257 -245 -235 -225 -215 -205 -192 -178 -160 -141 -123 -106 -93 -81 -73 -65 -56 -46 -36 -24 -13 -3 5 11 15 17 18 20 22 25 27 28 30 30 30 30 32 32 33 33 35 35 35 37 37 37 37 37 38 40 42 43 45 47 47 48 50 50 52 52 53 53 55 57 58 58 60 63 65 67 67 68 70 72 73 75 78 80 83 85 88 90 90 92 93 97 99 102 105 107 110 112 114 115 117 119 122 124 127 129 132 134 135 137 137 137 139 139 139 139 137 137 137 137 135 134 130 127 120 114 107 99 93 88 85 82 80 77 72 67 60 53 47 42 38 35 32 28 25 22 17 13 10 6 5 3 3 1 1 1 0 0 0 -1 -1 -1 -1 -1 -1 -3 -3 -3 -3 -3 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 -1 -1 -3 -3 -4 -4 -4 -6 -6 -6 -6 -6 -8 -8 -8 -6 -6 -6 -6 -6 -4 -4 -3 -3 -1 -1 -1 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 1 6 11 18 25 30 35 33 28 18 1 -19 -44 -71 -100 -126 -153 -178 -203 -227 -252 -279 -306 -334 -362 -391 -414 -434 -449 -459 -465 -466 -468 -470 -473 -476 -480 -480 -476 -466 -451 -431 -409 -386 -362 -342 -322 -307 -292 -280 -269 -257 -244 -232 -218 -205 -193 -183 -172 -160 -148 -136 -123 -111 -100 -91 -83 -75 -66 -58 -46 -34 -21 -9 0 10 17 22 27 28 30 32 33 35 37 37 38 40 42 43 45 47 48 50 50 50 50 52 52 52 52 52 53 53 55 55 57 57 58 58 60 60 62 63 65 67 68 70 70 72 72 73 75 75 77 78 80 82 83 85 87 88 88 90 92 95 99 100 104 105 107 109 110 110 112 114 115 119 122 124 127 129 130 134 135 137 140 142 144 145 145 145 147 147 147 147 149 149 149 149 147 144 140 137 134 129 125 120 115 110 105 99 92 85 78 72 67 62 55 50 47 42 37 32 28 25 20 18 17 15 13 13 11 11 11 10 10 10 8 6 6 5 5 3 3 1 1 1 1 0 0 0 0 0 0 0 0 0 0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -1 -1 -1 -1 -1 -1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
aVL_00= [-2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 0 0 0 2 4 7 9 10 14 17 21 26 31 37 44 52 59 66 71 74 77 79 79 79 77 77 77 77 77 79 81 84 89 96 104 114 126 136 144 151 154 158 159 161 163 164 166 166 166 166 163 159 156 151 146 141 134 128 119 109 97 86 74 62 51 41 31 22 14 5 0 -4 -9 -10 -12 -12 -12 -14 -14 -14 -15 -15 -17 -17 -17 -19 -19 -19 -19 -19 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -22 -22 -22 -24 -24 -24 -24 -24 -24 -24 -25 -25 -25 -25 -25 -25 -25 -27 -27 -27 -29 -29 -29 -29 -30 -30 -30 -30 -30 -32 -32 -32 -34 -34 -35 -35 -35 -37 -37 -37 -37 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -39 -37 -37 -37 -35 -35 -34 -34 -32 -30 -30 -29 -27 -27 -25 -24 -22 -20 -17 -15 -14 -12 -10 -10 -10 -9 -9 -7 -7 -5 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -2 -2 -2 0 0 0 0 0 0 0 -2 -2 -2 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -4 -4 -4 -4 -2 -2 0 0 2 2 4 4 4 4 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 -2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 4 5 7 9 10 12 14 15 19 24 29 36 42 49 56 61 66 69 72 72 71 71 69 67 67 67 67 69 72 76 81 84 89 94 97 103 108 114 119 126 133 138 143 146 149 151 151 151 151 149 148 144 139 133 124 116 106 96 87 79 69 61 52 42 34 26 17 10 5 0 -2 -4 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -9 -9 -9 -9 -9 -10 -10 -10 -10 -10 -10 -10 -10 -10 -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 -12 -14 -14 -14 -15 -15 -15 -15 -15 -15 -15 -17 -17 -19 -19 -19 -20 -20 -20 -20 -20 -22 -22 -22 -22 -22 -24 -24 -24 -25 -25 -27 -27 -27 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -29 -27 -27 -27 -27 -27 -25 -25 -25 -25 -24 -24 -24 -24 -22 -20 -19 -17 -14 -10 -9 -7 -5 -5 -4 -4 -4 -2 -2 0 0 2 4 4 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4 4 4 4 4 2 2 2 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 4 4 4 4 4 4 4 4 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 4 5 5 7 7 9 9 9 9 9 9 9 9 9 9 9 9 9 9 7 7 5 4 4 4 4 4 4 5 7 7 9 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 12 12 14 15 19 21 22 26 29 32 37 44 51 57 62 66 67 67 66 64 62 61 59 59 59 59 57 57 59 61 62 66 71 77 86 94 103 113 121 129 136 139 141 143 141 141 141 139 139 139 138 134 129 123 114 104 96 87 82 76 71 64 54 44 32 22 14 9 5 4 2 2 0 0 0 -2 -4 -4 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -5 -7 -7 -7 -7 -7 -7 -9 -9 -9 -7 -7 -7 -7 -7 -7 -7 -7 -9 -9 -9 -9 -10 -10 -10 -10 -10 -10 -10 -10 -10 -12 -12 -12 -14 -14 -14 -15 -15 -17 -17 -19 -19 -19 -20 -20 -20 -20 -20 -20 -20 -20 -20 -20 -22 -22 -22 -22 -22 -20 -20 -20 -20 -19 -19 -19 -19 -19 -17 -17 -15 -14 -12 -12 -10 -9 -9 -7 -7 -5 -5 -4 -2 0 0 0 2 2 4 4 4 4 4 4 4 5 5 5 5 7 7 7 9 9 9 9 9 9 9 9 9 10 10 10 10 9 9 9 9 7 7 7 7 7 7 7 7 7 9 9 9 9 10 10 10 10 10 10 10 9 9 9 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 9 9 9 9 9 9 9 9 9 9 7 7 7 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5]

fs = 500
interval = 0.5;

sample = aVL_00  %--> on finds peak one finds slur 
sample_smooth = movmean(sample,10)

%========================================================================================================================================
%% STEP 1 
%R Peak Identification on RAW and Smooth Data, R Peak Correction on RAW and Smooth Data, Step up for STEP 2
%========================================================================================================================================

[qrspeaks,locs,iwt_y, tm] = find_RPeaks(sample_smooth,fs)                  %FUNCTION 1 --> wavelet transform 
[locs_smooth] = R_Correction(sample_smooth,tm,fs,locs)                     %FUNCTION 2 --> Correction wavelet transform
[locs] = R_Correction(sample,tm,fs,locs)

[STARTTIME] = BIGRS_StartTime(sample,locs,fs,tm,1)
[STARTTIME1] = BIGRS_StartTime(sample,locs,fs,tm,2)

figure 
hold on 
plot(tm, sample_smooth)
xline(locs(1))
xline(STARTTIME)
xline(locs(2))
xline(STARTTIME1)

%========================================================================================================================================
%% STEP 2 
%R to R Peak Segmentation 
%========================================================================================================================================

number_of_peaks = length(locs);
RR_LocsSeg = zeros(2,number_of_peaks)                                      %Declare 2D arrray 2 by N 
number_of_time_steps = 0                                                        %-->            Seg1 ... SegN
                                                                                %--> SegStart 
QRS_StartSegment = zeros(1,number_of_peaks+1)                                   %--> SegEnd
for x=1:1:number_of_peaks
    QRS_StartSegment(x) = BIGRS_StartTime(sample,locs,fs,tm,x)             %Create array of all RS start times
end
QRS_StartSegment(number_of_peaks+1) = tm(length(tm))                       %Add sample end time to array 

for x=1:1:number_of_peaks                                                  %Populate RR_LocsSeg
    RR_LocsSeg(1,x) = locs(x)
    RR_LocsSeg(2,x) = QRS_StartSegment(x+1)
    
    if (QRS_StartSegment(x+1) - locs(x)) > number_of_time_steps
        number_of_time_steps = QRS_StartSegment(x+1) - locs(x)
    end
end 
number_of_time_steps = fix(number_of_time_steps *fs) 
RR_Segment = ones(number_of_peaks,number_of_time_steps)*999                %Segmentended Value R-R Signal: length of largest segment, inital values set to 999. Any value of 999 is rejected in future steps
RR_TimeSegment = ones(number_of_time_steps,number_of_peaks)*99             %Segmentended Time R-R Signal: length of largest segment, inital values set to 99. Any value of 99 is rejected in future steps
for x=1:1:number_of_peaks                                                  %Populate
    seg_vals = sample(fix(RR_LocsSeg(1,x)*fs)+1:fix(RR_LocsSeg(2,x)*fs)+1)
    seg_time = tm(fix(RR_LocsSeg(1,x)*fs)+1:fix(RR_LocsSeg(2,x)*fs)+1)
    RR_Segment(x,1:length(seg_vals)) = seg_vals                            %LENGTH OF SEGMENT-->((RR_LocsSeg(x,2)-RR_LocsSeg(x,1))*fs)+1
    RR_TimeSegment(1:length(seg_time),x) = seg_time                        
end     

figure()
hold on
for x=1:1:number_of_peaks
    steps =fix((RR_LocsSeg(2,x)-RR_LocsSeg(1,x))*fs)
    subplot(number_of_peaks,1,x)
    plot(RR_TimeSegment(1:steps,x),RR_Segment(x,1:steps))
    xline(RR_LocsSeg(1,x))
    xline(RR_LocsSeg(2,x))
    title("STEP 2: RAW R-R Segment")
end
hold off 
%========================================================================================================================================
%% STEP 3
%Smooth R-R, Take Derivates and Graph
%========================================================================================================================================

steps =fix((RR_LocsSeg(2,1)-RR_LocsSeg(1,1))*fs)
temp = RR_Segment(1,1:steps)
RR_SegmentSmooth = movmean(RR_Segment(1,1:steps),10)                       %Smooth R-R Segment 

slope = zeros(1,steps-2) 
for x=2:1:length(slope)
    slope(x-1) = (RR_SegmentSmooth(x+1)-RR_SegmentSmooth(x-1))/(2*(1/fs)*100) %Take first derivative 
end

RR_localMax = islocalmax(RR_SegmentSmooth)                                  %FOR TESTING PROGRAM ONLY 
RR_localMin = islocalmin(RR_SegmentSmooth)
Slope_localMax = islocalmax(slope)
Slope_localMin = islocalmin(slope)
figure()
subplot(3,1,1)
plot(RR_TimeSegment(1:steps,1),RR_Segment(1,1:steps))
title(["STEP 3: RAW R-R Segment"])
subplot(3,1,2)
hold on
plot(RR_TimeSegment(1:steps-2,1),RR_SegmentSmooth(1,1:steps-2))
plot(RR_TimeSegment(1:steps-2,1),slope)
plot(RR_TimeSegment(RR_localMax),RR_SegmentSmooth(RR_localMax), '*r') 
plot(RR_TimeSegment(RR_localMin),RR_SegmentSmooth(RR_localMin), '*b')
title(["STEP 3: Smooth R-R Segment"])
subplot(3,1,3)
hold on
yline(0)
yline(-11.8)
plot(RR_TimeSegment(1:steps-2,1),RR_SegmentSmooth(1,1:steps-2),'--k')
plot(RR_TimeSegment(1:steps-2,1),slope)
plot(RR_TimeSegment(RR_localMax),RR_SegmentSmooth(RR_localMax), '*r') 
plot(RR_TimeSegment(RR_localMin),RR_SegmentSmooth(RR_localMin), '*b')
plot(RR_TimeSegment(Slope_localMax),slope(Slope_localMax), '*y') 
plot(RR_TimeSegment(Slope_localMin),slope(Slope_localMin), '*m')
title(["STEP 3: Smooth R-R Segment"])

%========================================================================================================================================
%% STEP 4
% Segment S min to T max
%========================================================================================================================================
flag = true

RR_localMax = islocalmax(RR_SegmentSmooth)
RR_localMax = RR_localMax .* RR_SegmentSmooth
[S_max_value S_max_time] = max(RR_localMax)                                %Find the hightest point in the segment 

RR_localMin = islocalmin(RR_SegmentSmooth)
RR_localMin = RR_localMin .* RR_SegmentSmooth
while flag
    [S_min_value S_min_time] = min(RR_localMin)                            %Find the lowest point in the segment 
    if (S_min_time > S_max_time)
        RR_localMin(S_min_time) = 0 
    else
        flag = false
    end
end
ST_SegmentSmooth = RR_SegmentSmooth(S_min_time:S_max_time)
ST_Slope = slope(S_min_time:S_max_time)

S_max_time = S_max_time * 1/fs                                             %Adjust times to be in seconds 
S_min_time = S_min_time * 1/fs                                             %Adjust times to be in seconds  


second_slope = zeros(1,length(ST_Slope)-2)                                 %Take second derivative 
for x=2:1:length(second_slope)
    second_slope(x-1) = -1*(ST_Slope(x+1)-ST_Slope(x-1))/(2*(1/fs)*100)
end
[T_end_value, T_end_time]= min(second_slope)                               %Find min --> reflects the largest change in slope, merger of S and T wave
T_end_time = T_end_time * 1/fs
T_end_time = T_end_time + S_min_time+ RR_LocsSeg(1,1)
 

figure()
hold on 
plot(RR_TimeSegment(1:steps-2,1),RR_SegmentSmooth(1,1:steps-2),'--k')
plot(RR_TimeSegment(1:steps-2,1),slope)
plot((S_min_time+1/fs+ RR_LocsSeg(1,1):1/fs:S_max_time-1/fs+ RR_LocsSeg(1,1)),second_slope)
plot(T_end_time,RR_SegmentSmooth(fix((T_end_time-RR_LocsSeg(1,1))*fs)+1),'*y')
xline(S_min_time + RR_LocsSeg(1,1))
xline(S_max_time + RR_LocsSeg(1,1))

%========================================================================================================================================
%% STEP 5
% Segment R peak to S max
%========================================================================================================================================

RT_SegmentSmooth = RR_SegmentSmooth(1:S_min_time*fs)
RT_Slope = slope(1:S_min_time*fs)

RS_second_slope = zeros(1,length(RT_Slope)-2)                              %Take second derivative 
for x=2:1:length(second_slope)
    RS_second_slope(x-1) = -1*(RT_Slope(x+1)-RT_Slope(x-1))/(2*(1/fs)*100)
end

% RS_second_slope = movmean(RS_second_slope,15)
% [RS_start_value, RS_start_time]= min(ST_second_slope)                      %Find min --> reflects the largest change in slope, merger of S and T wave
% RS_start_time = RS_start_time * 1/fs
% RS_start_time = RS_start_time + RR_LocsSeg(1,1)
RS_start_time = 0 
[y pos] = min(RT_Slope)
pos = pos + 5
SegSlope = RT_Slope(pos:length(RT_Slope))
SegSlope = movmean(SegSlope, 5)
for x=2:1:length(SegSlope)
    if SegSlope(x-1) <= SegSlope(x)
    else
        test = x
        RS_start_time = (test+pos)*(1/fs)+ RR_LocsSeg(1,1)
        break
    end
end


  % RT_SegmentSmooth(fix((T_start_time-RR_LocsSeg(1,1))*fs))
figure()
hold on 
plot(RR_TimeSegment(1:S_min_time*fs,1),RT_SegmentSmooth,'--k')
plot(RR_TimeSegment(1:S_min_time*fs,1),RT_Slope,'r')
%plot(RR_TimeSegment(2:(S_min_time*fs)-1,1),RS_second_slope,'r')
%plot(RS_start_time,sample_smooth(fix(RS_start_time*fs)+1),'*r')
xline(RS_start_time)

%========================================================================================================================================
%% STEP 6
% FULL QRS SEGEMENT 
%========================================================================================================================================

[R_START] = BIGRS_StartTime(sample,locs,fs,tm,1)
R_PEAK = locs(1)
R_END = RS_start_time
S_MIN = S_min_time + locs(1)
S_END = T_end_time-1/fs

QRS_SEGMENTSMOOTH = sample_smooth(fix(R_START*fs):fix(S_END*fs))
QRS_SEGMENTTIME = tm(fix(R_START*fs):fix(S_END*fs))
QRS_total_time = S_END - R_START

figure()
hold on
plot(QRS_SEGMENTTIME,QRS_SEGMENTSMOOTH)
xline(R_START,'g')
xline(R_PEAK,'b')
xline(R_END,'m')
xline(S_MIN,'y')
xline(S_END,'r')

%========================================================================================================================================
%% STEP Slur Search 
% Accending Side  
%========================================================================================================================================
SLURTIME_A = 0 
AccendingSegment = sample_smooth(fix(R_START*fs)+20:fix(R_PEAK*fs)-10)
AccendingTime = tm(fix(R_START*fs)+20:fix(R_PEAK*fs)-10)
AccendingSlope = zeros(1,length(AccendingSegment)-2) 
for x=2:1:length(AccendingSlope)
    AccendingSlope(x-1) = (AccendingSegment(x+1)-AccendingSegment(x-1))/(2*(1/fs)*100) %Take first derivative 
end

for x=1:1:length(AccendingSlope)-1
    if abs(AccendingSlope(x)) > abs(AccendingSlope(x+1))
        if AccendingSlope(x) <= 1
            SLURTIME_A = AccendingTime(2) + (x*1/fs)
            break
        end
    end
end 

figure ()
hold on 
plot(AccendingTime,AccendingSegment)
plot(AccendingTime(2:length(AccendingTime)-1),AccendingSlope)
if SLURTIME_A > 0
    xline(SLURTIME_A)
end

%========================================================================================================================================
%% STEP Slur Search 
% Decending Side  
%========================================================================================================================================
SLURTIME_D = 0 
AccendingSegment = sample_smooth(fix(R_PEAK*fs)+10:fix(R_END*fs)-10)
AccendingTime = tm(fix(R_PEAK*fs)+10:fix(R_END*fs)-10)
AccendingSlope = zeros(1,length(AccendingSegment)-2) 
for x=2:1:length(AccendingSlope)
    AccendingSlope(x-1) = (AccendingSegment(x+1)-AccendingSegment(x-1))/(2*(1/fs)*100) %Take first derivative 
end

for x=1:1:length(AccendingSlope)
    if abs(AccendingSlope(x)) > abs(AccendingSlope(x+1))
        if AccendingSlope(x) <= 1
            SLURTIME_D = AccendingTime(2) + (x*1/fs)
            break
        end
    end
end 

figure ()
hold on 
plot(AccendingTime,AccendingSegment)
plot(AccendingTime(2:length(AccendingTime)-1),AccendingSlope)
if SLURTIME_A > 0
    xline(SLURTIME_D)
end


%========================================================================================================================================
%% STEP 6
% FULL QRS SEGEMENT 
%========================================================================================================================================

[R_START] = BIGRS_StartTime(sample,locs,fs,tm,1)
R_PEAK = locs(1)
R_END = RS_start_time
S_MIN = S_min_time + locs(1)
S_END = T_end_time-1/fs

QRS_SEGMENTSMOOTH = sample_smooth(fix(R_START*fs):fix(S_END*fs))
QRS_SEGMENTTIME = tm(fix(R_START*fs):fix(S_END*fs))
QRS_total_time = S_END - R_START

figure()
hold on
plot(QRS_SEGMENTTIME,QRS_SEGMENTSMOOTH)
xline(R_START,'g')
xline(R_PEAK,'b')
xline(R_END,'m')
xline(S_MIN,'y')
xline(S_END,'r')
if SLURTIME_A > 0
    xline(SLURTIME_A,'r')
end
if SLURTIME_D > 0
    xline(SLURTIME_D,'r')
end
